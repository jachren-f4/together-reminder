<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Power Level Showdown: Memory Challenge</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .game-container {
            max-width: 900px;
            width: 100%;
            background: white;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            padding: 24px;
            text-align: center;
            color: white;
            position: relative;
        }
        .pvp-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255,255,255,0.2);
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
        }
        .memory-badge {
            position: absolute;
            top: 16px;
            left: 16px;
            background: rgba(255,255,255,0.25);
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            border: 1px solid rgba(255,255,255,0.4);
        }
        h1 { font-family: 'Playfair Display', serif; font-size: 32px; margin-bottom: 8px; }
        .subtitle { opacity: 0.9; font-size: 14px; margin-bottom: 4px; }
        .subtitle2 { opacity: 0.8; font-size: 12px; font-style: italic; }
        .game-screen { padding: 32px; min-height: 500px; }

        .phase-title {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 24px;
            font-size: 18px;
            font-weight: 700;
            color: #19547b;
        }

        .info-banner {
            background: linear-gradient(135deg, #e7f5ff 0%, #d0ebff 100%);
            border-left: 4px solid #339af0;
            padding: 16px 20px;
            border-radius: 12px;
            margin-bottom: 24px;
        }
        .info-title {
            font-weight: 700;
            color: #1864ab;
            margin-bottom: 8px;
            font-size: 14px;
        }
        .info-text {
            font-size: 13px;
            color: #364fc7;
            line-height: 1.6;
        }

        .power-meters {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 28px;
        }
        .power-meter {
            background: #f8f9fa;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
        }
        .power-meter.you { border: 3px solid #ffd89b; }
        .power-meter.opponent { border: 3px solid #19547b; }
        .power-label {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .memory-score {
            font-size: 11px;
            background: #e7f5ff;
            padding: 4px 10px;
            border-radius: 8px;
            color: #1971c2;
        }
        .power-value {
            font-size: 48px;
            font-weight: 700;
            color: #ffd89b;
            margin-bottom: 12px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .power-bar {
            background: #dee2e6;
            height: 12px;
            border-radius: 6px;
            overflow: hidden;
        }
        .power-fill {
            background: linear-gradient(90deg, #ffd89b 0%, #ff9a00 100%);
            height: 100%;
            transition: width 0.5s ease;
        }

        .question-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
            border: 2px solid #dee2e6;
        }
        .question-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px dashed #dee2e6;
        }
        .quiz-emoji {
            font-size: 36px;
        }
        .quiz-info {
            flex: 1;
        }
        .quiz-date {
            font-size: 11px;
            color: #868e96;
            margin-bottom: 4px;
        }
        .quiz-type {
            font-size: 13px;
            font-weight: 600;
            color: #495057;
        }
        .question-text {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            text-align: center;
        }
        .question-subtext {
            font-size: 13px;
            color: #868e96;
            text-align: center;
            margin-bottom: 20px;
            font-style: italic;
        }
        .answers-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        .answer-btn {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 14px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            position: relative;
        }
        .answer-btn:hover {
            border-color: #ffd89b;
            background: #fffbf0;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 216, 155, 0.3);
        }
        .answer-btn.correct {
            border-color: #51cf66;
            background: #d3f9d8;
        }
        .answer-btn.wrong {
            border-color: #ff6b6b;
            background: #ffe3e3;
        }
        .answer-btn.partner-answer:after {
            content: "üë® Bob's Answer";
            position: absolute;
            top: -10px;
            right: 8px;
            background: #19547b;
            color: white;
            font-size: 9px;
            padding: 2px 8px;
            border-radius: 6px;
            font-weight: 700;
        }

        .result-feedback {
            background: #fff3bf;
            border-left: 4px solid #fab005;
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
            font-size: 14px;
        }
        .result-feedback.correct {
            background: #d3f9d8;
            border-left-color: #37b24d;
        }
        .result-feedback.wrong {
            background: #ffe3e3;
            border-left-color: #ff6b6b;
        }

        .beam-struggle {
            display: none;
            text-align: center;
            margin: 40px 0;
        }
        .beam-struggle.active { display: block; }
        .beam-emoji { font-size: 120px; margin-bottom: 20px; animation: shake 0.5s infinite; }
        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            75% { transform: translateX(5px) rotate(2deg); }
        }
        .clash-text {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            font-weight: 700;
            color: #ff9a00;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        .memory-stats {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }
        .stat-item {
            text-align: center;
        }
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            color: #19547b;
            margin-bottom: 4px;
        }
        .stat-label {
            font-size: 12px;
            color: #666;
        }

        .btn {
            display: inline-block;
            padding: 16px 32px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(25, 84, 123, 0.3);
        }

        .result-screen {
            display: none;
            text-align: center;
        }
        .result-screen.active { display: block; }
        .result-emoji { font-size: 120px; margin-bottom: 24px; }
        .result-title { font-family: 'Playfair Display', serif; font-size: 42px; margin-bottom: 16px; }
        .result-title.victory { color: #2b8a3e; }
        .result-title.defeat { color: #c92a2a; }
        .final-stats {
            background: #f8f9fa;
            border-radius: 16px;
            padding: 24px;
            margin: 24px auto;
            max-width: 500px;
        }
        .final-stat-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #dee2e6;
        }
        .final-stat-row:last-child {
            border-bottom: none;
        }

        .back-link {
            display: block;
            text-align: center;
            color: #19547b;
            text-decoration: none;
            margin-top: 16px;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .power-meters { grid-template-columns: 1fr; }
            .answers-grid { grid-template-columns: 1fr; }
            .memory-stats { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <div class="memory-badge">üß† MEMORY</div>
            <div class="pvp-badge">‚öîÔ∏è PVP</div>
            <h1>‚ö° Power Level Showdown üí™</h1>
            <p class="subtitle">Memory Challenge Edition</p>
            <p class="subtitle2">"What Do You Remember About Me?"</p>
        </div>

        <div class="game-screen">
            <div id="gameScreen">
                <div class="info-banner">
                    <div class="info-title">üß† How This Works</div>
                    <div class="info-text">
                        Questions are pulled from your <strong>actual quiz history</strong>!
                        Alice answers questions about what <strong>Bob said</strong> in past quizzes.
                        Bob answers about what <strong>Alice said</strong>.
                        Correct answers charge your power level. Then your powers clash!
                    </div>
                </div>

                <div class="phase-title" id="phaseTitle">MEMORY CHALLENGE - Prove You Remember!</div>

                <div class="power-meters">
                    <div class="power-meter you">
                        <div class="power-label">
                            üë© Alice (You)
                            <span class="memory-score" id="yourCorrect">0/5 ‚úì</span>
                        </div>
                        <div class="power-value" id="yourPower">0</div>
                        <div class="power-bar">
                            <div class="power-fill" id="yourPowerBar" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="power-meter opponent">
                        <div class="power-label">
                            üë® Bob
                            <span class="memory-score" id="bobCorrect">0/5 ‚úì</span>
                        </div>
                        <div class="power-value" id="bobPower">0</div>
                        <div class="power-bar">
                            <div class="power-fill" id="bobPowerBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <div class="question-card" id="questionCard">
                    <div class="question-header">
                        <div class="quiz-emoji" id="quizEmoji">üìù</div>
                        <div class="quiz-info">
                            <div class="quiz-date" id="quizDate">From: Classic Quiz ‚Ä¢ 3 days ago</div>
                            <div class="quiz-type" id="quizType">Question about Bob</div>
                        </div>
                    </div>
                    <div class="question-text" id="questionText">Bob said his favorite food is...</div>
                    <div class="question-subtext" id="questionSubtext">What did Bob answer when you played this quiz together?</div>
                    <div class="answers-grid" id="answersGrid"></div>
                    <div class="result-feedback" id="resultFeedback" style="display: none;"></div>
                </div>

                <div class="beam-struggle" id="beamStruggle">
                    <div class="beam-emoji">‚ö°üí•‚ö°</div>
                    <div class="clash-text">MEMORY CLASH!</div>
                    <div class="memory-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="aliceMemoryScore">4</div>
                            <div class="stat-label">Alice Remembered</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="bobMemoryScore">3</div>
                            <div class="stat-label">Bob Remembered</div>
                        </div>
                    </div>
                    <p style="font-size: 16px; color: #666; margin-bottom: 24px;">
                        Powers charged based on memory accuracy...
                    </p>
                    <button class="btn" onclick="resolveClash()">See Who Wins! ‚Üí</button>
                </div>
            </div>

            <div class="result-screen" id="resultScreen">
                <div class="result-emoji" id="resultEmoji">üéâ</div>
                <h2 class="result-title" id="resultTitle">Memory Master!</h2>
                <p id="resultMsg" style="color: #666; margin-bottom: 24px; font-size: 18px;">
                    You remembered more about Bob!
                </p>

                <div class="final-stats">
                    <div class="final-stat-row">
                        <span style="font-weight: 600;">Alice's Memory Accuracy:</span>
                        <span style="font-weight: 700; color: #19547b;" id="aliceFinalAccuracy">4/5 (80%)</span>
                    </div>
                    <div class="final-stat-row">
                        <span style="font-weight: 600;">Bob's Memory Accuracy:</span>
                        <span style="font-weight: 700; color: #19547b;" id="bobFinalAccuracy">3/5 (60%)</span>
                    </div>
                    <div class="final-stat-row">
                        <span style="font-weight: 600;">Alice's Final Power:</span>
                        <span style="font-weight: 700; color: #ffd89b;" id="aliceFinalPower">920</span>
                    </div>
                    <div class="final-stat-row">
                        <span style="font-weight: 600;">Bob's Final Power:</span>
                        <span style="font-weight: 700; color: #ffd89b;" id="bobFinalPower">740</span>
                    </div>
                </div>

                <button class="btn" onclick="location.reload()">‚ö° Test Memory Again</button>
                <a href="index.html" class="back-link">‚Üê Back to Games</a>
            </div>
        </div>
    </div>

    <script>
        // Simulated historical quiz data (in real app, this would come from Firebase/Hive)
        const historicalQuestions = [
            {
                quizType: "Classic Quiz",
                quizEmoji: "üìù",
                date: "3 days ago",
                askedAbout: "Bob",
                question: "Bob said his favorite food is...",
                bobsAnswer: "Pizza",
                options: ["Pizza", "Sushi", "Tacos", "Burgers"]
            },
            {
                quizType: "Would You Rather",
                quizEmoji: "ü§î",
                date: "1 week ago",
                askedAbout: "Bob",
                question: "Bob chose: Beach vacation or Mountain retreat?",
                bobsAnswer: "Beach vacation",
                options: ["Beach vacation", "Mountain retreat"]
            },
            {
                quizType: "Affirmation Quiz",
                quizEmoji: "‚ù§Ô∏è",
                date: "2 days ago",
                askedAbout: "Bob",
                question: "Bob rated 'We communicate openly' as...",
                bobsAnswer: "Strongly Agree",
                options: ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"]
            },
            {
                quizType: "Classic Quiz",
                quizEmoji: "üìù",
                date: "5 days ago",
                askedAbout: "Bob",
                question: "Bob's dream vacation destination was...",
                bobsAnswer: "Japan",
                options: ["Japan", "Italy", "Hawaii", "Iceland"]
            },
            {
                quizType: "Speed Round",
                quizEmoji: "‚ö°",
                date: "4 days ago",
                askedAbout: "Bob",
                question: "Bob said he usually wakes up at...",
                bobsAnswer: "7 AM",
                options: ["6 AM", "7 AM", "8 AM", "9 AM"]
            }
        ];

        let state = {
            questionIndex: 0,
            yourPower: 0,
            bobPower: 0,
            yourCorrect: 0,
            bobCorrect: 0
        };

        function showQuestion() {
            if (state.questionIndex >= historicalQuestions.length) {
                startMemoryClash();
                return;
            }

            const q = historicalQuestions[state.questionIndex];

            // Update header
            document.getElementById('quizEmoji').textContent = q.quizEmoji;
            document.getElementById('quizDate').textContent = `From: ${q.quizType} ‚Ä¢ ${q.date}`;
            document.getElementById('quizType').textContent = `Question about ${q.askedAbout}`;

            // Update question
            document.getElementById('questionText').textContent = q.question;
            document.getElementById('questionSubtext').textContent =
                `What did ${q.askedAbout} answer when you played this quiz together?`;

            // Hide previous feedback
            document.getElementById('resultFeedback').style.display = 'none';

            // Render answers
            const grid = document.getElementById('answersGrid');
            grid.innerHTML = '';
            q.options.forEach((ans, i) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn';
                btn.textContent = ans;

                // Mark Bob's actual answer
                if (ans === q.bobsAnswer) {
                    btn.classList.add('partner-answer');
                }

                btn.onclick = () => answerQuestion(ans, q.bobsAnswer);
                grid.appendChild(btn);
            });
        }

        function answerQuestion(selected, correctAnswer) {
            const yourCorrect = selected === correctAnswer;

            // Bob simulates (random 60-80% accuracy)
            const bobCorrect = Math.random() > 0.3;

            // Update correct counts
            if (yourCorrect) state.yourCorrect++;
            if (bobCorrect) state.bobCorrect++;

            // Update displays
            document.getElementById('yourCorrect').textContent = `${state.yourCorrect}/5 ‚úì`;
            document.getElementById('bobCorrect').textContent = `${state.bobCorrect}/5 ‚úì`;

            // Calculate power gain
            const yourPowerGain = yourCorrect ?
                Math.floor(Math.random() * 50) + 200 : // 200-250 if correct
                Math.floor(Math.random() * 30) + 50;   // 50-80 if wrong

            const bobPowerGain = bobCorrect ?
                Math.floor(Math.random() * 50) + 200 :
                Math.floor(Math.random() * 30) + 50;

            state.yourPower += yourPowerGain;
            state.bobPower += bobPowerGain;

            // Update power displays
            document.getElementById('yourPower').textContent = state.yourPower;
            document.getElementById('bobPower').textContent = state.bobPower;

            const yourPercent = Math.min(100, (state.yourPower / 1200) * 100);
            const bobPercent = Math.min(100, (state.bobPower / 1200) * 100);

            document.getElementById('yourPowerBar').style.width = yourPercent + '%';
            document.getElementById('bobPowerBar').style.width = bobPercent + '%';

            // Highlight correct/wrong answers
            document.querySelectorAll('.answer-btn').forEach(btn => {
                btn.disabled = true;
                if (btn.textContent === correctAnswer) {
                    btn.classList.add('correct');
                } else if (btn.textContent === selected && !yourCorrect) {
                    btn.classList.add('wrong');
                }
            });

            // Show feedback
            const feedback = document.getElementById('resultFeedback');
            feedback.style.display = 'block';

            if (yourCorrect) {
                feedback.className = 'result-feedback correct';
                feedback.innerHTML = `
                    ‚úÖ <strong>Correct!</strong> You remembered! +${yourPowerGain} power!<br>
                    <span style="font-size: 12px; opacity: 0.8;">Bob ${bobCorrect ? 'also remembered ‚úì' : 'forgot this one ‚úó'}</span>
                `;
            } else {
                feedback.className = 'result-feedback wrong';
                feedback.innerHTML = `
                    ‚ùå <strong>Wrong!</strong> Bob actually said "${correctAnswer}". +${yourPowerGain} power (partial credit)<br>
                    <span style="font-size: 12px; opacity: 0.8;">Bob ${bobCorrect ? 'remembered this ‚úì' : 'also forgot ‚úó'}</span>
                `;
            }

            state.questionIndex++;

            if (state.questionIndex < historicalQuestions.length) {
                setTimeout(showQuestion, 3000);
            } else {
                setTimeout(startMemoryClash, 3000);
            }
        }

        function startMemoryClash() {
            document.getElementById('questionCard').style.display = 'none';
            document.getElementById('phaseTitle').textContent = 'CLASH PHASE - Memory Powers Colliding!';
            document.getElementById('beamStruggle').classList.add('active');

            document.getElementById('aliceMemoryScore').textContent = state.yourCorrect;
            document.getElementById('bobMemoryScore').textContent = state.bobCorrect;
        }

        function resolveClash() {
            document.getElementById('gameScreen').style.display = 'none';
            document.getElementById('resultScreen').classList.add('active');

            const aliceAccuracy = Math.round((state.yourCorrect / 5) * 100);
            const bobAccuracy = Math.round((state.bobCorrect / 5) * 100);

            // Update final stats
            document.getElementById('aliceFinalAccuracy').textContent = `${state.yourCorrect}/5 (${aliceAccuracy}%)`;
            document.getElementById('bobFinalAccuracy').textContent = `${state.bobCorrect}/5 (${bobAccuracy}%)`;
            document.getElementById('aliceFinalPower').textContent = state.yourPower;
            document.getElementById('bobFinalPower').textContent = state.bobPower;

            if (state.yourPower > state.bobPower) {
                document.getElementById('resultEmoji').textContent = 'üß†';
                document.getElementById('resultTitle').textContent = 'Memory Master!';
                document.getElementById('resultTitle').className = 'result-title victory';
                document.getElementById('resultMsg').innerHTML =
                    `You remembered more about Bob!<br><span style="font-size: 16px; opacity: 0.8;">Power: ${state.yourPower} vs ${state.bobPower}</span>`;
            } else if (state.bobPower > state.yourPower) {
                document.getElementById('resultEmoji').textContent = 'üí≠';
                document.getElementById('resultTitle').textContent = 'Bob Remembers Better!';
                document.getElementById('resultTitle').className = 'result-title defeat';
                document.getElementById('resultMsg').innerHTML =
                    `Bob's memory was sharper this time!<br><span style="font-size: 16px; opacity: 0.8;">Power: ${state.bobPower} vs ${state.yourPower}</span>`;
            } else {
                document.getElementById('resultEmoji').textContent = 'ü§ù';
                document.getElementById('resultTitle').textContent = 'Equal Memory!';
                document.getElementById('resultMsg').innerHTML =
                    `You both remembered equally well!<br><span style="font-size: 16px; opacity: 0.8;">Power: ${state.yourPower}</span>`;
            }
        }

        showQuestion();
    </script>
</body>
</html>
